<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="kycManagementMapper">


	<resultMap type="com.path.vo.core.aml.KycManagementCO"
		id="returnKycManagementDataMap">

		<result column="COMP_CODE" property="amlKycVO.COMP_CODE" />
		<result column="CODE" property="amlKycVO.CODE" />
		<result column="CIF_NO" property="amlKycVO.CIF_NO" />
		<result column="ENTITY_STATUS"
			property="amlKycVO.ENTITY_STATUS" />
		<result column="STATUS_DESC" property="statusDesc" />
		<result column="SHORT_NAME_ENG" property="desc" />
		<result column="CIF_TYPE" property="cifType" />
		<result column="CREATED_BY" property="amlKycVO.CREATED_BY" />
		<result column="MODIFIED_BY" property="amlKycVO.MODIFIED_BY" />
		<result column="LANGUAGE" property="cifLanguage" />
		<result column="VT_IND" property="rifcttVO.VT_IND" />
		
		
	</resultMap>

	<resultMap type="com.path.vo.core.aml.KycManagementCO"
		id="resKycManagementListMap">
		<result column="CODE" property="amlKycVO.CODE" />
		<result column="CIF_NO" property="amlKycVO.CIF_NO" />
		<result column="ENTITY_STATUS"
			property="amlKycVO.ENTITY_STATUS" />
		<result column="STATUS_DESC" property="statusDesc" />
	</resultMap>

	<resultMap type="com.path.vo.core.aml.KycManagementCO" id="returnMapCif">

		<result column="SHORT_NAME_ENG" property="cifVO.SHORT_NAME_ENG" />
		<result column="CIF_TYPE" property="cifVO.CIF_TYPE" />
		<result column="STATUS" property="cifVO.STATUS" />
		<result column="LANGUAGE" property="cifLanguage" />
		<result column="VT_IND" property="rifcttVO.VT_IND" />
	</resultMap>

	<resultMap id="itrCifKycMap"
		type="com.path.dbmaps.vo.CTS_DYN_CIF_KYCVO">
		<result column="COMP_CODE" property="COMP_CODE" />
		<result column="CIF_NO" property="CIF_NO" />
		<result column="QUESTION_ID" property="QUESTION_ID" />
		<result column="SCREEN_ID" property="SCREEN_ID" />
		<result column="ANSWER" property="ANSWER" />
	</resultMap>

	<resultMap id="financialCountryMap"
		type="com.path.dbmaps.vo.COUNTRIESVO">
		<result column="COUNTRY_CODE" property="COUNTRY_CODE" />
		<result column="BRIEF_DESC_ENG" property="BRIEF_DESC_ENG" />
		<result column="BRIEF_DESC_ARAB" property="BRIEF_DESC_ARAB" />
		<result column="LONG_DESC_ENG" property="LONG_DESC_ENG" />
		<result column="LONG_DESC_ARAB" property="LONG_DESC_ARAB" />
	</resultMap>

	<resultMap id="cifCountryInfoMap"
		type="com.path.vo.core.csmfom.CIFCountryInfoCO">
		<result column="COMP_CODE"
			property="cifCountryInfoVO.COMP_CODE" />
		<result column="CIF_NO" property="cifCountryInfoVO.CIF_NO" />
		<result column="COUNTRY_CODE"
			property="cifCountryInfoVO.COUNTRY_CODE" />
		<result column="ID_NO" property="cifCountryInfoVO.ID_NO" />
		<result column="KYC_FINANCIAL_COUNTRY_DESC"
			property="KYC_FINANCIAL_COUNTRY_DESC" />
	</resultMap>
 <resultMap id="kycFinancialInfoMap"        type="com.path.vo.core.csmfom.CIF_KYC_FINANCIAL_INFOCO">
	  	<result column="CIF_NO" property="cifKycFinancialInfoVO.CIF_NO" />
	    <result column="COMP_CODE" property="cifKycFinancialInfoVO.COMP_CODE" />
	    <result column="KYC_FINANCIAL_TYPE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_TYPE" />
	    <result column="LINE_NO" property="cifKycFinancialInfoVO.LINE_NO" />
	    <result column="KYC_FINANCIAL_NAME" property="cifKycFinancialInfoVO.KYC_FINANCIAL_NAME" />
	    <result column="KYC_FINANCIAL_NATIONALITY" property="cifKycFinancialInfoVO.KYC_FINANCIAL_NATIONALITY" />
	    <result column="KYC_FINANCIAL_CIVIL_ID" property="cifKycFinancialInfoVO.KYC_FINANCIAL_CIVIL_ID" />
	    <result column="KYC_FINANCIAL_BIRTH_DATE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_BIRTH_DATE" />
	    <result column="KYC_FINANCIAL_BIRTH_PLACE_OLD" property="cifKycFinancialInfoVO.KYC_FINANCIAL_BIRTH_PLACE_OLD" />
	    <result column="KYC_FINANCIAL_GENDER" property="cifKycFinancialInfoVO.KYC_FINANCIAL_GENDER" />
	    <result column="KYC_FINANCIAL_ADDRESS" property="cifKycFinancialInfoVO.KYC_FINANCIAL_ADDRESS" />
	    <result column="KYC_FINANCIAL_EMPLOYER" property="cifKycFinancialInfoVO.KYC_FINANCIAL_EMPLOYER" />
	    <result column="KYC_FINANCIAL_POSITION" property="cifKycFinancialInfoVO.KYC_FINANCIAL_POSITION" />
	    <result column="KYC_FINANCIAL_PEP" property="cifKycFinancialInfoVO.KYC_FINANCIAL_PEP" />
	    <result column="KYC_FINANCIAL_PHONE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_PHONE" />
	    <result column="KYC_FINANCIAL_EMAIL" property="cifKycFinancialInfoVO.KYC_FINANCIAL_EMAIL" />
	    <result column="KYC_FINANC_TOTAL_INCOME_YEAR1" property="cifKycFinancialInfoVO.KYC_FINANC_TOTAL_INCOME_YEAR1" />
	    <result column="KYC_FINANC_TOTAL_INCOME_YEAR2" property="cifKycFinancialInfoVO.KYC_FINANC_TOTAL_INCOME_YEAR2" />
	    <result column="KYC_FINANC_TOTAL_INCOME_YEAR3" property="cifKycFinancialInfoVO.KYC_FINANC_TOTAL_INCOME_YEAR3" />
	    <result column="KYC_FINANC_OPER_PROFIT_YEAR1" property="cifKycFinancialInfoVO.KYC_FINANC_OPER_PROFIT_YEAR1" />
	    <result column="KYC_FINANC_OPER_PROFIT_YEAR2" property="cifKycFinancialInfoVO.KYC_FINANC_OPER_PROFIT_YEAR2" />
	    <result column="KYC_FINANC_OPER_PROFIT_YEAR3" property="cifKycFinancialInfoVO.KYC_FINANC_OPER_PROFIT_YEAR3" />
	    <result column="KYC_FINANC_NET_PROFIT_YEAR1" property="cifKycFinancialInfoVO.KYC_FINANC_NET_PROFIT_YEAR1" />
	    <result column="KYC_FINANC_NET_PROFIT_YEAR2" property="cifKycFinancialInfoVO.KYC_FINANC_NET_PROFIT_YEAR2" />
	    <result column="KYC_FINANC_NET_PROFIT_YEAR3" property="cifKycFinancialInfoVO.KYC_FINANC_NET_PROFIT_YEAR3" />
	    <result column="KYC_FINANC_EARNING_YEAR1" property="cifKycFinancialInfoVO.KYC_FINANC_EARNING_YEAR1" />
	    <result column="KYC_FINANC_EARNING_YEAR2" property="cifKycFinancialInfoVO.KYC_FINANC_EARNING_YEAR2" />
	    <result column="KYC_FINANC_EARNING_YEAR3" property="cifKycFinancialInfoVO.KYC_FINANC_EARNING_YEAR3" />
	    <result column="KYC_FINANCIAL_BANK_NAME" property="cifKycFinancialInfoVO.KYC_FINANCIAL_BANK_NAME" />
	    <result column="KYC_FINANCIAL_CURRENCY_CODE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_CURRENCY_CODE" />
	    <result column="KYC_FINANCIAL_AVG_ACC_BAL" property="cifKycFinancialInfoVO.KYC_FINANCIAL_AVG_ACC_BAL" />
	    <result column="KYC_FINANCIAL_CUSTOMER_REF" property="cifKycFinancialInfoVO.KYC_FINANCIAL_CUSTOMER_REF" />
	    <result column="KYC_FINANCIAL_FIRST_NAME" property="cifKycFinancialInfoVO.KYC_FINANCIAL_FIRST_NAME" />
	    <result column="KYC_FINANCIAL_LAST_NAME" property="cifKycFinancialInfoVO.KYC_FINANCIAL_LAST_NAME" />
	    <result column="KYC_FINANCIAL_STREET" property="cifKycFinancialInfoVO.KYC_FINANCIAL_STREET" />
	    <result column="KYC_FINANCIAL_CIF_TYPE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_CIF_TYPE" />
	    <result column="KYC_FINANCIAL_ZIP_CODE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_ZIP_CODE" />
	    <result column="KYC_FINANCIAL_COUNTRY" property="cifKycFinancialInfoVO.KYC_FINANCIAL_COUNTRY" />
	    <result column="KYC_FINANCIAL_CITY" property="cifKycFinancialInfoVO.KYC_FINANCIAL_CITY" />
	    <result column="KYC_FINANCIAL_PASSPORT_NUMBER" property="cifKycFinancialInfoVO.KYC_FINANCIAL_PASSPORT_NUMBER" />
	    <result column="KYC_FINANCIAL_BIRTH_COUNTRY" property="cifKycFinancialInfoVO.KYC_FINANCIAL_BIRTH_COUNTRY" />
	    <result column="KYC_FINANCIAL_POLITICAL_POS" property="cifKycFinancialInfoVO.KYC_FINANCIAL_POLITICAL_POS" />
	    <result column="KYC_FINANCIAL_TIN" property="cifKycFinancialInfoVO.KYC_FINANCIAL_TIN" />
	    <result column="KYC_FINANCIAL_ECONOMIC_SECTOR" property="cifKycFinancialInfoVO.KYC_FINANCIAL_ECONOMIC_SECTOR" />
	    <result column="KYC_FINANCIAL_SHARES" property="cifKycFinancialInfoVO.KYC_FINANCIAL_SHARES" />
	    <result column="KYC_FINANCIAL_SHARES_PERC" property="cifKycFinancialInfoVO.KYC_FINANCIAL_SHARES_PERC" />
	    <result column="KYC_FINANCIAL_RELATIONSHIP" property="cifKycFinancialInfoVO.KYC_FINANCIAL_RELATIONSHIP" />
	    <result column="KYC_FINANC_CUSTOMER_REF_CODE" property="cifKycFinancialInfoVO.KYC_FINANC_CUSTOMER_REF_CODE" />
	    <result column="KYC_FINANCIAL_CIF_CATEGORY" property="cifKycFinancialInfoVO.KYC_FINANCIAL_CIF_CATEGORY" />
	    <result column="KYC_FINANC_BIRTH_REGION" property="cifKycFinancialInfoVO.KYC_FINANC_BIRTH_REGION" />
	    <result column="KYC_FINANC_RESID_OP_REGION" property="cifKycFinancialInfoVO.KYC_FINANC_RESID_OP_REGION" />
	    <result column="KYC_FINANCIAL_BIRTH_PLACE" property="cifKycFinancialInfoVO.KYC_FINANCIAL_BIRTH_PLACE" />	    
	    <result column="KYC_FNCIAL_BIRTH_COUNTRY_DESC" property="KYC_FINANCIAL_BIRTH_COUNTRY_DESC" />
	    <result column="KYC_NATIONALITY_DESC" property="KYC_NATIONALITY_DESC" />
	    <result column="KYC_REGION_DESC" property="KYC_REGION_DESC" />
	    <result column="KYC_CITY_DESC" property="KYC_CITY_DESC" />
	    <result column="KYC_CIF_TYPE_DESC" property="KYC_CIF_TYPE_DESC" />
	    <result column="KYC_FINANCIAL_COUNTRY_DESC" property="KYC_FINANCIAL_COUNTRY_DESC" />
	    <result column="KYC_ADDRESS_REGION_DESC" property="KYC_ADDRESS_REGION_DESC" />
	    <result column="KYC_ADDRESS_CITY_DESC" property="KYC_ADDRESS_CITY_DESC" />
	    <result column="KYC_FINANCIAL_EC_SECTOR_DESC" property="KYC_FINANCIAL_ECONOMIC_SECTOR_DESC" />
	    <result column="KYC_FNCIAL_POLITICAL_POS_DESC" property="KYC_FINANCIAL_POLITICAL_POS_DESC" />
	    <result column="INCOME_INTREST_YN" property="cifKycFinancialInfoVO.INCOME_INTREST_YN" />
	    <result column="INCOME_RENTS_YN" property="cifKycFinancialInfoVO.INCOME_RENTS_YN" />
	    <result column="INCOME_CAPITAL_YN" property="cifKycFinancialInfoVO.INCOME_CAPITAL_YN" />
	    <result column="OTHER_INCOME_YN" property="cifKycFinancialInfoVO.OTHER_INCOME_YN" />
	    <result column="OTHER_INCOME" property="cifKycFinancialInfoVO.OTHER_INCOME" />
	    <result column="ID_NO"  	 	 	property="cifKycFinancialInfoVO.ID_NO" />
	    <result column="ID_TYPE"  	  		property="cifKycFinancialInfoVO.ID_TYPE" />
	    <result column="NO_DAYS_THIS_YEAR"  property="cifKycFinancialInfoVO.NO_DAYS_THIS_YEAR" />
	    <result column="NO_DAYS_LAST_YEAR"  property="cifKycFinancialInfoVO.NO_DAYS_LAST_YEAR" />
	    <result column="OLDER_DAYS"  	  	property="cifKycFinancialInfoVO.OLDER_DAYS" />
	    <result column="PERCENTAGE_VOTING_RIGHT"  	  	property="cifKycFinancialInfoVO.PERCENTAGE_VOTING_RIGHT" />
	    <result column="ROLE_CODE"  	  	property="cifKycFinancialInfoVO.ROLE_CODE" />
	    <result column="COMP_LICENSE_NO"  	property="cifKycFinancialInfoVO.COMP_LICENSE_NO" />
	    <result column="COMP_MEMORANDUM_NO" property="cifKycFinancialInfoVO.COMP_MEMORANDUM_NO" />
	    <result column="EXPIRY_DATE"  	  	property="cifKycFinancialInfoVO.EXPIRY_DATE" />
	    <result column="HOUSE_BUILDING"   	property="cifKycFinancialInfoVO.HOUSE_BUILDING" />
	    <result column="PO_BOX"  	  		property="cifKycFinancialInfoVO.PO_BOX" />
	    <result column="STATE"  	  		property="cifKycFinancialInfoVO.STATE" />
	    <result column="GOVERNATE"  	  	property="cifKycFinancialInfoVO.GOVERNATE" />
	    <result column="POSTAL_CODE"  	  	property="cifKycFinancialInfoVO.POSTAL_CODE" />
	    <result column="FAX"  	  			property="cifKycFinancialInfoVO.FAX" />
	    <result column="AVENUE"  	  		property="cifKycFinancialInfoVO.AVENUE" />
	    <result column="PURPOSE"  	  		property="cifKycFinancialInfoVO.PURPOSE" />
	    <result column="roleDesc"  	  		property="roleDesc" />
	    <result column="idTypeDesc"  	  	property="idTypeDesc" />
	    <result column="cifDesc"  	  		property="cifDesc" />
	    <result column="poBoxAreaDesc"  	property="poBoxAreaDesc" />
	    <result column="postalcodeDesc"  	property="postalcodeDesc" />
  	</resultMap>
  		<resultMap id="returnFomKycDescriptionMap" type="fomCO">
	<result column="COUNTRY_KYC_DESC" property="countryKYCDesc" />
	<result column="INCOME_BUSINESS_COUNTRY_DESC" property="incomeBusinessCntryDesc" />
	<result column="OPENING_ACCPURPOSE_DESC"
		property="kycOpeningAccPurposeDesc" />
	<result column="RESIDENT_BANKNAME"
		property="kycResidentBankName" />
	<result column="BUSINESS_ECOSECTOR_DESC"
		property="kycBusinessEcoSectorDesc" />
	<result column="GREENCARD_COUNTRY_DESC"
		property="kycGreenCardCountryDesc" />
	<result column="LONGSTAY_COUNTRY_DESC"
		property="kycLongStayCountryDesc" />
	<result column="TAXPAYER_COUNTRY_DESC"
		property="kycTaxPayerCountryDesc" />
	<result column="STANDINSTR_COUNTRY_DESC"
		property="kycStandInstrCountryDesc" />
	<result column="REMITTER_BENEF_DESC"
		property="kycRemitterBenefNationalityDesc" />
	<result column="ATTORNEY_COUNTRY_DESC"
		property="kycAttorneyCountryDesc" />
	<result column="STANDINSTR_COUNTRY_DESC"
		property="kycStandInstrCountryDesc" />
	<result column="ADDRESS_COUNTRY_DESC"
		property="kycAddressCountryDesc" />
	<result column="kycAddressPostalCodeDesc"
		property="kycAddressPostalCodeDesc" />
	<result column="kycRegionDesc" property="kycRegionDesc" />
	<result column="ymcTypeOfAccountDesc"
		property="ymcTypeOfAccountDesc" />
	<result column="kycSourceOfWealth" property="kycSourceOfWealth" />
	<result column="ymcOtherCntryDesc" property="ymcOtherCntryDesc" />
	<result column="recvIncomeCntryDesc"
		property="recvIncomeCntryDesc" />
	<result column="compCountryDesc" property="compCountryDesc" />
	<result column="incomeThroughDesc" property="incomeThroughDesc" />
	<result column="depositThroughDesc"
		property="depositThroughDesc" />
	<result column="ymcStatusDesc" property="ymcStatusDesc" />
</resultMap>

	<select id="kycManagementData"
		parameterType="com.path.vo.core.aml.KycManagementSC"
		resultMap="returnKycManagementDataMap">

		SELECT
		AML_KYC.ENTITY_STATUS,
		(SELECT VALUE_DESC
		FROM
		SYS_PARAM_LOV_TRANS
		WHERE LOV_TYPE_ID = #{lovTypeId}
		AND LANG_CODE =
		#{language}
		AND
		VALUE_CODE = AML_KYC.ENTITY_STATUS) STATUS_DESC,
		AML_KYC.COMP_CODE,
		AML_KYC.CODE,
		AML_KYC.CIF_NO,
		AML_KYC.CREATED_BY,
		AML_KYC.MODIFIED_BY,
		CIF.SHORT_NAME_ENG,
		CIF.CIF_TYPE,
		CIF.LANGUAGE,
		RIFCTT.VT_IND
		FROM AML_KYC,CIF,RIFCTT
		WHERE (AML_KYC.COMP_CODE=#{compCode,jdbcType=NUMERIC})
		AND
		(AML_KYC.BRANCH_CODE=#{branchCode,jdbcType=NUMERIC})
		AND (AML_KYC.CODE
		= #{code,jdbcType=NUMERIC})
		AND AML_KYC.COMP_CODE=CIF.COMP_CODE
		AND
		AML_KYC.CIF_NO=CIF.CIF_NO
		AND CIF.COMP_CODE= RIFCTT.COMP_CODE
		AND CIF.CIF_TYPE=RIFCTT.TYPE_CODE

	</select>

	<sql id="queryKycManagementSQL">
		SELECT
		AML_KYC.ENTITY_STATUS,
		(SELECT VALUE_DESC
		FROM
		SYS_PARAM_LOV_TRANS
		WHERE LOV_TYPE_ID = #{lovTypeId}
		AND LANG_CODE =
		#{language}
		AND
		VALUE_CODE = AML_KYC.ENTITY_STATUS) STATUS_DESC,
		AML_KYC.CODE,
		AML_KYC.CIF_NO
		FROM AML_KYC
		WHERE
		(AML_KYC.COMP_CODE=#{compCode,jdbcType=NUMERIC})
		AND
		(AML_KYC.BRANCH_CODE=#{branchCode,jdbcType=NUMERIC})
		<if test='ivCrud == "U"'>
			AND (AML_KYC.ENTITY_STATUS='P')
		</if>
		<if test='ivCrud == "P"'>
			AND (AML_KYC.ENTITY_STATUS='A')
		</if>

	</sql>

	<select id="returnKycManagementList"
		parameterType="com.path.vo.core.aml.KycManagementSC"
		resultMap="resKycManagementListMap">
		<include refid="servicesCommon.commonGridWrpBefFlip" />
		<include refid="queryKycManagementSQL" />
		<include refid="servicesCommon.commonGridWrpAftFlip" />
		<include refid="servicesCommon.commmonGridWrpFlipClose" />
	</select>
	<select id="returnKycManagementCount"
		parameterType="com.path.vo.core.aml.KycManagementSC" resultType="int">
		<include refid="servicesCommon.commonGridWrpBefCnt" />
		<include refid="queryKycManagementSQL" />
		<include refid="servicesCommon.commonGridWrpAftCnt" />
		<include refid="servicesCommon.commonGridCountWrpClose" />
	</select>

	<select id="returnCountByCode" resultType="Integer"
		parameterType="com.path.vo.core.aml.KycManagementCO">
		select count(1) from AML_KYC
		where (COMP_CODE =
		#{amlKycVO.COMP_CODE,jdbcType=NUMERIC} )
		AND BRANCH_CODE=
		#{amlKycVO.BRANCH_CODE,jdbcType=NUMERIC}
		AND CODE =
		#{amlKycVO.CODE,jdbcType=NUMERIC}
	</select>


	<update id="approveKyc"
		parameterType="com.path.vo.core.aml.KycManagementCO">
		<include refid="kycManagementMapper.sql_approve" />
	</update>

	<sql id="sql_approve">
		UPDATE AML_KYC
		<set>
			COMP_CODE = #{amlKycVO.COMP_CODE,jdbcType=NUMERIC},
			ENTITY_STATUS
			= 'P',
			AML_KYC.APPROVED_BY=#{amlKycVO.APPROVED_BY,jdbcType=VARCHAR},
			AML_KYC.APPROVED_DATE=#{amlKycVO.APPROVED_DATE,jdbcType=TIMESTAMP}
		</set>
		WHERE
		COMP_CODE = #{amlKycVO.COMP_CODE,jdbcType=NUMERIC}
		AND
		BRANCH_CODE=#{amlKycVO.BRANCH_CODE,jdbcType=NUMERIC}
		AND
		CODE=#{amlKycVO.CODE,jdbcType=NUMERIC}
	</sql>


	<select id="returnByCifCode" resultMap="returnMapCif"
		parameterType="com.path.vo.core.aml.KycManagementCO">
		SELECT CIF_NO,SHORT_NAME_ENG, STATUS,CIF_TYPE,LANGUAGE,VT_IND
		FROM CIF,RIFCTT
		WHERE CIF.COMP_CODE =
		#{amlKycVO.COMP_CODE,jdbcType=NUMERIC}
		AND CIF.CIF_NO =
		#{amlKycVO.CIF_NO,jdbcType=NUMERIC}
		AND CIF.COMP_CODE = RIFCTT.COMP_CODE
		AND CIF.CIF_TYPE  = RIFCTT.TYPE_CODE
	</select>

	<select id="returnCountByCifCode" resultType="Integer"
		parameterType="com.path.vo.core.aml.KycManagementCO">
		select count(1) from AML_KYC
		where (COMP_CODE =
		#{amlKycVO.COMP_CODE,jdbcType=NUMERIC} )
		AND BRANCH_CODE=
		#{amlKycVO.BRANCH_CODE,jdbcType=NUMERIC}
		AND CIF_NO =
		#{amlKycVO.CIF_NO,jdbcType=NUMERIC}
	</select>
	<sql id="retCifCountryInfoGridSql">
		SELECT
		COMP_CODE,
		CIF_NO,
		COUNTRY_CODE,
		ID_NO,
		(SELECT
		LONG_DESC_ENG FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{compCode}
		AND COUNTRY_CODE = CIF_COUNTRY_INFO.COUNTRY_CODE)
		KYC_FINANCIAL_COUNTRY_DESC
		FROM CIF_COUNTRY_INFO
		WHERE COMP_CODE =
		#{compCode}
		AND CIF_NO = #{cifNo,jdbcType=NUMERIC}
	</sql>

	<select id="retCifCountryInfoGridCount" resultType="int"
		parameterType="com.path.vo.core.aml.KycManagementSC">
		<include refid="servicesCommon.commonGridWrpBefCnt" />
		<include refid="retCifCountryInfoGridSql" />
		<include refid="servicesCommon.commonGridWrpAftCnt" />
		<include refid="servicesCommon.commonGridCountWrpClose" />
	</select>
	<select id="retCifCountryInfoGrid" parameterType="fomSC"
		resultMap="cifCountryInfoMap">
		<include refid="servicesCommon.commonGridWrpBefFlip" />
		<include refid="retCifCountryInfoGridSql" />
		<include refid="servicesCommon.commonGridWrpAftFlip" />
		<include refid="servicesCommon.commmonGridWrpFlipClose" />
	</select>

	<select id="retYmcFinancialBirthCountryCount" resultType="int"
		parameterType="fomSC">
		<include refid="servicesCommon.commonGridWrpBefCnt" />
		<include refid="retYmcFinancialBirthCountrySql" />
		<include refid="servicesCommon.commonGridWrpAftCnt" />
		<include refid="servicesCommon.commonGridCountWrpClose" />
	</select>

	<select id="retYmcFinancialBirthCountry"
		parameterType="com.path.vo.core.aml.KycManagementSC"
		resultMap="financialCountryMap">
		<include refid="servicesCommon.commonGridWrpBefFlip" />
		<include refid="retYmcFinancialBirthCountrySql" />
		<include refid="servicesCommon.commonGridWrpAftFlip" />
		<include refid="servicesCommon.commmonGridWrpFlipClose" />
	</select>

	<sql id="retYmcFinancialBirthCountrySql">
		SELECT COUNTRY_CODE,
		BRIEF_DESC_ENG ,
		BRIEF_DESC_ARAB ,
		LONG_DESC_ENG ,
		LONG_DESC_ARAB
		FROM COUNTRIES
		WHERE COUNTRIES.COMP_CODE = #{compCode}
		<if test="country != null">
			AND COUNTRY_CODE = #{country}
		</if>
		<if test='"ymcIn".equals(ADD_STRING2)'>
			AND COUNTRY_CODE <![CDATA[<>]]>
			(SELECT COUNTRY_CODE
			FROM ITR_REG_INDICIA_COUNTRY
			WHERE TAX_REG_ID =
			(SELECT TAX_REG_ID
			FROM ITR_CONTROL
			WHERE IS_FATCA_REGULATION_YN = 1
			AND COMP_CODE = #{compCode}))
		</if>
	</sql>


	<select id="countUSControl"
		parameterType="com.path.vo.core.aml.KycManagementSC"
		resultType="java.math.BigDecimal">
		SELECT count(1)
		FROM COUNTRIES
		WHERE ISO_COUNTRY = 'US'
		and (
		COUNTRY_CODE = #{country,jdbcType=NUMERIC}
		or COUNTRY_CODE =
		#{country1,jdbcType=NUMERIC}
		or COUNTRY_CODE =
		#{country2,jdbcType=NUMERIC}
		or COUNTRY_CODE =
		#{country3,jdbcType=NUMERIC}
		or COUNTRY_CODE =
		#{country4,jdbcType=NUMERIC}
		or COUNTRY_CODE IN (SELECT COUNTRY_CODE
		FROM CIF_COUNTRY_INFO WHERE
		COMP_CODE=#{compCode,jdbcType=NUMERIC} AND
		CIF_NO=#{cifNo,jdbcType=NUMERIC})
		or COUNTRY_CODE IN (SELECT
		KYC_FINANCIAL_COUNTRY FROM
		CIF_KYC_FINANCIAL_INFO WHERE
		COMP_CODE=#{compCode,jdbcType=NUMERIC}
		AND KYC_FINANCIAL_TYPE='E' AND
		CIF_NO=#{cifNo,jdbcType=NUMERIC})
		<if test="nationality != null">
			or exists( SELECT 1 FROM NATIONALITY WHERE ISO_NATIONALITY
			= 'USA' AND
			COMP_CODE = COUNTRIES.COMP_CODE and CODE =
			#{nationality,jdbcType=NUMERIC})
		</if>
		)
	</select>


	<delete id="deleteAllINGrid" parameterType="fomSC">
		DELETE FROM
		CIF_KYC_FINANC_INFO_CNTRY
		WHERE COMP_CODE = #{compCode}
		AND CIF_NO =
		#{cifNo,jdbcType=NUMERIC}
	</delete>
	<delete id="deleteCifCountryInfo" parameterType="fomSC">
		DELETE FROM
		CIF_COUNTRY_INFO WHERE COMP_CODE=#{compCode} AND
		CIF_NO=#{cifNo,jdbcType=NUMERIC}
	</delete>
	<select id="returnMaxLineNo"
		parameterType="com.path.vo.core.csmfom.FomPopUpSceensSC"
		resultType="int">
		SELECT

		<if test="useLineNumber!=null and useLineNumber!= ''">
			CASE WHEN MAX(LINE_NUMBER) IS NULL THEN 0 ELSE
			MAX(LINE_NUMBER) END
		</if>

		<if test="useLineNo!=null and useLineNo!= ''">
			CASE WHEN MAX(LINE_NO) IS NULL THEN 0 ELSE MAX(LINE_NO)
			END
		</if>

		<if test="useMainlineno!=null and useMainlineno!= ''">
			CASE WHEN MAX(MAIN_LINE_NO) IS NULL THEN 0 ELSE
			MAX(MAIN_LINE_NO) END
		</if>

		FROM

		<if test="tableName!=null and tableName!= ''">
			${tableName}
		</if>

		<where>

			<if test="compCode!=null and compCode!= ''">
				COMP_CODE=(#{compCode, jdbcType=NUMERIC})
			</if>

			<if test="branchCode!=null and branchCode!= ''">
				BRANCH_CODE=(#{branchCode, jdbcType=NUMERIC})
			</if>

			<if test="cifNo!=null and cifNo!= ''">
				AND CIF_NO=(#{cifNo, jdbcType=NUMERIC})
			</if>

			<if test="cifCode!=null and cifCode!= ''">
				AND CIF_CODE=(#{cifCode, jdbcType=NUMERIC})
			</if>

			<if test="detailsType!=null and detailsType!= ''">
				AND DETAILS_TYPE=(#{detailsType, jdbcType=VARCHAR})
			</if>

		</where>

	</select>

	<update id="updateMainCifData" parameterType="fomCO">
		UPDATE CIF
		SET DATE_UPDATED = #{cifVO.DATE_UPDATED}
		<if test="cifVO.STATUS != null">
			,STATUS = #{cifVO.STATUS}
		</if>
		<if test="cifVO.PEPS != null">
			,PEPS = #{cifVO.PEPS}
		</if>
		WHERE CIF_NO = #{cifVO.CIF_NO}
		AND COMP_CODE = #{cifVO.COMP_CODE}
		<if test="dateUpdated != null">
			AND DATE_UPDATED = #{dateUpdated}
		</if>
	</update>
	<select id="returnKycAuditHeaderFields"
		resultType="java.lang.String">
		SELECT CIF_KYC_AUDIT_HEADER.FIELD_NAME
		FROM
		CIF_KYC_AUDIT_HEADER
	</select>

	<select id="returnPreviousKycStatus" parameterType="cifSC"
		resultType="string">
		SELECT KYC_COMPLETED
		FROM CIF
		WHERE COMP_CODE
		=#{compCode,jdbcType=NUMERIC}
		AND CIF_NO =#{cif_no,jdbcType=NUMERIC}
	</select>

	<select id="returnMaxAuditLineNO" parameterType="cifSC"
		resultType="int">
		SELECT CASE WHEN MAX (LINE_NO) = NULL THEN 0 ELSE
		MAX(LINE_NO) END
		FROM CIF_KYC_AUDIT_DET
		WHERE CIF_KYC_AUDIT_DET.CIF_NO
		=#{cif_no,jdbcType=NUMERIC}
	</select>

	<select id="returnKycSeqNO" parameterType="cifSC"
		resultType="java.math.BigDecimal">
		SELECT CIF_KYC_AUDIT_HEADER.SEQ_NO
		FROM CIF_KYC_AUDIT_HEADER
		WHERE FIELD_NAME=#{searchField,jdbcType=VARCHAR}
	</select>
	
	
	<select id="retKycFinancialInfoCount"  resultType="int" parameterType="fomSC">
		<include refid="servicesCommon.commonGridWrpBefCnt"/>
		<include refid="retKycFinancialInfoListSql"/>
		<include refid="servicesCommon.commonGridWrpAftCnt"/>
		<include refid="servicesCommon.commonGridCountWrpClose"/>
	</select>	
	
	
	<sql id="retKycFinancialInfoListSql">	
		SELECT
		CIF_NO, COMP_CODE, KYC_FINANCIAL_TYPE, LINE_NO, KYC_FINANCIAL_NAME, KYC_FINANCIAL_NATIONALITY, 
	    KYC_FINANCIAL_CIVIL_ID, KYC_FINANCIAL_BIRTH_DATE, KYC_FINANCIAL_BIRTH_PLACE_OLD, 
	    KYC_FINANCIAL_GENDER, KYC_FINANCIAL_ADDRESS, KYC_FINANCIAL_EMPLOYER, KYC_FINANCIAL_POSITION, 
	    KYC_FINANCIAL_PEP, KYC_FINANCIAL_PHONE, KYC_FINANCIAL_EMAIL, KYC_FINANC_TOTAL_INCOME_YEAR1, 
	    KYC_FINANC_TOTAL_INCOME_YEAR2, KYC_FINANC_TOTAL_INCOME_YEAR3, KYC_FINANC_OPER_PROFIT_YEAR1, 
	    KYC_FINANC_OPER_PROFIT_YEAR2, KYC_FINANC_OPER_PROFIT_YEAR3, KYC_FINANC_NET_PROFIT_YEAR1, 
	    KYC_FINANC_NET_PROFIT_YEAR2, KYC_FINANC_NET_PROFIT_YEAR3, KYC_FINANC_EARNING_YEAR1, 
	    KYC_FINANC_EARNING_YEAR2, KYC_FINANC_EARNING_YEAR3, KYC_FINANCIAL_BANK_NAME, KYC_FINANCIAL_CURRENCY_CODE, 
	    KYC_FINANCIAL_AVG_ACC_BAL, KYC_FINANCIAL_CUSTOMER_REF, KYC_FINANCIAL_FIRST_NAME, 
	    KYC_FINANCIAL_LAST_NAME, KYC_FINANCIAL_STREET, KYC_FINANCIAL_CIF_TYPE, KYC_FINANCIAL_ZIP_CODE, 
	    KYC_FINANCIAL_COUNTRY, KYC_FINANCIAL_CITY, KYC_FINANCIAL_PASSPORT_NUMBER, KYC_FINANCIAL_BIRTH_COUNTRY, 
	    KYC_FINANCIAL_POLITICAL_POS, KYC_FINANCIAL_TIN, KYC_FINANCIAL_ECONOMIC_SECTOR, KYC_FINANCIAL_SHARES, 
	    KYC_FINANCIAL_SHARES_PERC, KYC_FINANCIAL_RELATIONSHIP, KYC_FINANC_CUSTOMER_REF_CODE, 
	    KYC_FINANCIAL_CIF_CATEGORY, KYC_FINANC_BIRTH_REGION, KYC_FINANC_RESID_OP_REGION,KYC_FINANCIAL_BIRTH_PLACE,
		INCOME_INTREST_YN,
		INCOME_RENTS_YN,
		INCOME_CAPITAL_YN,
		OTHER_INCOME_YN,
		OTHER_INCOME,
		ID_NO,
		ID_TYPE, 
		NO_DAYS_THIS_YEAR,
		NO_DAYS_LAST_YEAR,
		OLDER_DAYS,
		PERCENTAGE_VOTING_RIGHT
		,ROLE_CODE
		,COMP_LICENSE_NO
		,COMP_MEMORANDUM_NO
		,EXPIRY_DATE
		,HOUSE_BUILDING
		,PO_BOX
		,STATE
		,GOVERNATE
		,POSTAL_CODE
		,AVENUE
		,FAX
		,PURPOSE
		,
	    (SELECT  LONG_DESC_ENG 	FROM  NATIONALITY WHERE	 NATIONALITY.COMP_CODE  = #{compCode}
	    	 AND CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_NATIONALITY) KYC_NATIONALITY_DESC,
	    (SELECT CIF.LONG_NAME_ENG FROM CIF WHERE COMP_CODE=#{compCode} and  CIF_NO=#{cifNo,jdbcType=NUMERIC})cifDesc,
	    (SELECT	LONG_DESC_ENG FROM  COUNTRIES WHERE COUNTRIES.COMP_CODE  = #{compCode} 
	    	AND COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_BIRTH_COUNTRY) KYC_FNCIAL_BIRTH_COUNTRY_DESC,
	    (SELECT  COUNTRIES_REGION.LONG_DESC_ENG FROM COUNTRIES_REGION WHERE COUNTRIES_REGION.REGION_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANC_BIRTH_REGION
	    	AND COUNTRIES_REGION.COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_BIRTH_COUNTRY AND COUNTRIES_REGION.COMP_CODE = #{compCode}) KYC_REGION_DESC,
	    (SELECT CITIES.LONG_DESC_ENG FROM  CITIES WHERE CITIES.COMP_CODE = #{compCode} AND CITIES.COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_NATIONALITY
			AND CITIES.REGION_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANC_BIRTH_REGION	
			AND CITIES.CITY_CODE =  CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_BIRTH_PLACE) KYC_CITY_DESC,
		(SELECT RIFCTT.BRIEF_DESC_ENG 	FROM  RIFCTT WHERE	 RIFCTT.COMP_CODE  = #{compCode} 
			AND RIFCTT.TYPE_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_CIF_TYPE) KYC_CIF_TYPE_DESC,
			
		(SELECT	LONG_DESC_ENG FROM  COUNTRIES WHERE COUNTRIES.COMP_CODE  = #{compCode} 
	    	AND COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_COUNTRY)  KYC_FINANCIAL_COUNTRY_DESC,
	    	 
	    (SELECT  COUNTRIES_REGION.LONG_DESC_ENG FROM COUNTRIES_REGION WHERE COUNTRIES_REGION.REGION_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANC_RESID_OP_REGION
	    	AND COUNTRIES_REGION.COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_COUNTRY AND COUNTRIES_REGION.COMP_CODE = #{compCode})	KYC_ADDRESS_REGION_DESC, 
	    (SELECT CITIES.LONG_DESC_ENG FROM  CITIES WHERE CITIES.COMP_CODE = #{compCode} AND CITIES.COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_COUNTRY
			AND CITIES.REGION_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANC_RESID_OP_REGION	
			AND CITIES.CITY_CODE =  CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_CITY) KYC_ADDRESS_CITY_DESC,
		(SELECT ECO_SECTORS.LONG_DESC_ENG FROM  ECO_SECTORS WHERE ECO_SECTORS.COMP_CODE  = #{compCode}
			AND SECTOR_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_ECONOMIC_SECTOR) KYC_FINANCIAL_EC_SECTOR_DESC,		



		(SELECT POSITIONS.LONG_DESC_ENG FROM POSITIONS WHERE POSITIONS.COMP_CODE = #{compCode}
				AND POSITION_CODE = 
								<choose>
								       <when test="isSybase == 1">
								      		CONVERT(NUMERIC,CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_POLITICAL_POS)
								       </when>
								       <otherwise>
								       TO_NUMBER(NVL(CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_POLITICAL_POS,'0'))
								       </otherwise>
						  		</choose>			
		) KYC_FNCIAL_POLITICAL_POS_DESC,
		(SELECT BRIEF_DESC_ENG FROM  CIF_ROLE 
				WHERE CIF_ROLE.ROLE_CODE = CIF_KYC_FINANCIAL_INFO.ROLE_CODE
				AND   CIF_ROLE.COMP_CODE  = #{compCode} ) roleDesc,
		(SELECT ID_TYPES.DESC_ENG FROM ID_TYPES WHERE ID_TYPES.COMP_CODE = #{compCode} AND ID_TYPES.CODE = CIF_KYC_FINANCIAL_INFO.ID_TYPE) idTypeDesc,
		(SELECT  COUNTRIES_REGION.BRIEF_DESC_ENG
	           FROM COUNTRIES_REGION
	           WHERE COUNTRIES_REGION.COMP_CODE = #{compCode}
	           AND COUNTRIES_REGION.COUNTRY_CODE =  CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_COUNTRY
	           AND COUNTRIES_REGION.REGION_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANC_RESID_OP_REGION) poBoxAreaDesc,
		 (SELECT POSTAL_CODE.BRIEF_NAME_ENG
	           FROM POSTAL_CODE
	          WHERE POSTAL_CODE.COMP_CODE  = #{compCode}
	            AND POSTAL_CODE.COUNTRY_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANCIAL_COUNTRY
	            AND POSTAL_CODE.REGION_CODE = CIF_KYC_FINANCIAL_INFO.KYC_FINANC_RESID_OP_REGION
	            AND POSTAL_CODE.POST_CODE   = <choose>
								       <when test="isSybase == 1">
								      		CONVERT(VARCHAR, CIF_KYC_FINANCIAL_INFO.POSTAL_CODE)
								       </when>
								       <otherwise>
								            CIF_KYC_FINANCIAL_INFO.POSTAL_CODE
								       </otherwise>
						  		</choose>			
	           
		       ) postalcodeDesc
			    
	    FROM CIF_KYC_FINANCIAL_INFO 
	    WHERE COMP_CODE = #{compCode} 
	    AND CIF_NO = #{cifNo,jdbcType=NUMERIC} 
	    AND KYC_FINANCIAL_TYPE = #{ADD_STRING2}
	    <if test="division != null">
	    	AND LINE_NO = #{division}
	    </if>
	</sql>	
	<select id="retDynScreenValues" parameterType="fomSC" resultMap="itrCifKycMap">
		SELECT * FROM CTS_DYN_CIF_KYC WHERE 
		COMP_CODE 		= #{compCode}
		AND CIF_NO 		= #{cifNo,jdbcType=NUMERIC}
		AND SCREEN_ID 	= #{baseCurrencyCode}
	</select>	
	
	<select id="retCifAddressCount" parameterType="fomSC"
	resultType="int">
	SELECT count(1) FROM CIF_ADDRESS
	WHERE COMP_CODE = #{compCode,jdbcType=NUMERIC}
	AND CIF_NO = #{cifNo,jdbcType=NUMERIC}
	AND LINE_NO <![CDATA[<>]]>
	0
</select>

<select id="returnFomKycAddress" parameterType="fomSC" resultType="addressVO">
		SELECT * FROM CIF_ADDRESS
		WHERE COMP_CODE = #{compCode,jdbcType=NUMERIC}
		AND  CIF_NO = #{cifNo,jdbcType=NUMERIC}
		AND IS_KYC_YN = '1'
	</select>
	
	  	<!-- kyc return desc -->
	<select id="returnFomKycDescription" parameterType="fomCO" resultMap="returnFomKycDescriptionMap">
		SELECT
		CASE 
			WHEN #{cifKYCVO.OTHER_PASSPORT_COUNTRY,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.OTHER_PASSPORT_COUNTRY,jdbcType=NUMERIC})
			ELSE ''
		END COUNTRY_KYC_DESC,
		
		CASE 
			WHEN #{cifKYCVO.INCOME_BUSINESS_COUNTRY,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'A' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.INCOME_BUSINESS_COUNTRY,jdbcType=NUMERIC})
			ELSE ''
		END INCOME_BUSINESS_COUNTRY_DESC,
		CASE 
			WHEN #{cifKYCVO.OPENING_ACC_PURPOSE,jdbcType=VARCHAR} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN CTSREASONS.BRIEF_NAME_ENG ELSE CTSREASONS.BRIEF_NAME_ARAB END)  FROM CTSREASONS WHERE CTSREASONS.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND CTSREASONS.REASON_TYPE = '${@com.path.bo.core.csmfom.FomConstant@OPENING_ACC_REASON}' 
				<choose>
  			       <when test="isSybase == 1">
  			       		AND CTSREASONS.CODE =  CONVERT(NUMERIC,ISNULL(#{cifKYCVO.OPENING_ACC_PURPOSE,jdbcType=VARCHAR},'0')))
  			       </when>
  			       <otherwise>
  			       		AND CTSREASONS.CODE =  TO_NUMBER(NVL(#{cifKYCVO.OPENING_ACC_PURPOSE,jdbcType=VARCHAR},'0')))
  			       </otherwise>
  			    </choose>
			ELSE ''
		END OPENING_ACCPURPOSE_DESC,
		CASE 
			WHEN #{cifKYCVO.RESIDENT_BANK_CIF_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT  (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN BRIEF_NAME_ENG ELSE BRIEF_NAME_ARAB END)
					FROM S_ADDITIONS_OPTIONS 
					WHERE S_ADDITIONS_OPTIONS.OPTION_SERIAL <![CDATA[<>]]> 0 
					AND S_ADDITIONS_OPTIONS.OPTION_CODE = (SELECT SMART_OPTION_TEXT5 
															FROM S_CONTROL 
															WHERE S_CONTROL.PROG_REFERENCE = 'CIFC000' 
															AND S_CONTROL.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC})
					 AND OPTION_SERIAL = #{cifKYCVO.RESIDENT_BANK_CIF_CODE,jdbcType=NUMERIC})
			ELSE ''
		END RESIDENT_BANKNAME,
		CASE 
			WHEN #{cifKYCVO.BUSINESS_ECO_SECTOR_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN ECO_SECTORS.LONG_DESC_ENG ELSE ECO_SECTORS.LONG_DESC_ARAB END)  FROM ECO_SECTORS WHERE ECO_SECTORS.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND ECO_SECTORS.SECTOR_CODE = #{cifKYCVO.BUSINESS_ECO_SECTOR_CODE,jdbcType=NUMERIC})
			ELSE ''
		END BUSINESS_ECOSECTOR_DESC,
		CASE 
			WHEN #{cifKYCVO.PERM_RESID_COUNTRY_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.PERM_RESID_COUNTRY_CODE,jdbcType=NUMERIC})
			ELSE ''
		END GREENCARD_COUNTRY_DESC,
		CASE 
			WHEN #{cifKYCVO.LONG_STAY_COUNTRY_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.LONG_STAY_COUNTRY_CODE,jdbcType=NUMERIC})
			ELSE ''
		END LONGSTAY_COUNTRY_DESC,
		CASE 
			WHEN #{cifKYCVO.TAX_PAYER_COUNTRY_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.TAX_PAYER_COUNTRY_CODE,jdbcType=NUMERIC})
			ELSE ''
		END TAXPAYER_COUNTRY_DESC,
		CASE 
			WHEN #{cifKYCVO.STAND_INSTR_COUNTRY_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.STAND_INSTR_COUNTRY_CODE,jdbcType=NUMERIC})
			ELSE ''
		END STANDINSTR_COUNTRY_DESC,
		CASE 
			WHEN #{cifKYCVO.REMITTER_BENEF_NATIONALITY,jdbcType=VARCHAR} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN NATIONALITY.BRIEF_DESC_ENG ELSE NATIONALITY.BRIEF_DESC_ARAB END)  FROM NATIONALITY WHERE NATIONALITY.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  
				 AND NATIONALITY.CODE = #{cifKYCVO.REMITTER_BENEF_NATIONALITY,jdbcType=NUMERIC})
			ELSE ''
		END REMITTER_BENEF_DESC,
		CASE 
			WHEN #{cifKYCVO.ATTORNEY_OUTSIDE_COUNTRY_CODE,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE = #{cifKYCVO.ATTORNEY_OUTSIDE_COUNTRY_CODE,jdbcType=NUMERIC})
			ELSE ''
		END ATTORNEY_COUNTRY_DESC,
		CASE 
			WHEN #{kycAddressCountryCode,jdbcType=NUMERIC} IS NOT NULL 
			THEN (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  AND COUNTRIES.COUNTRY_CODE = #{kycAddressCountryCode,jdbcType=NUMERIC})
			ELSE ''
		END ADDRESS_COUNTRY_DESC,
		(SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN POSTAL_CODE.BRIEF_NAME_ENG ELSE POSTAL_CODE.BRIEF_NAME_ARAB END) 
	           FROM POSTAL_CODE
	          WHERE POSTAL_CODE.COMP_CODE  =  #{loginCompCode,jdbcType=NUMERIC} 
	            AND POSTAL_CODE.COUNTRY_CODE = #{kycAddressCountryCode,jdbcType=NUMERIC}
	            AND POSTAL_CODE.REGION_CODE =  #{kycRegion,jdbcType=NUMERIC}
	            AND POSTAL_CODE.POST_CODE   =  <choose>
												       <when test="isSybase == 1">
												      		CONVERT(VARCHAR, #{kycAddressPostalCode,jdbcType=NUMERIC})
												       </when>
												       <otherwise>
												           #{kycAddressPostalCode,jdbcType=NUMERIC}
												       </otherwise>
										  		</choose>)kycAddressPostalCodeDesc,
	    (SELECT  (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES_REGION.BRIEF_DESC_ENG ELSE COUNTRIES_REGION.BRIEF_DESC_ARAB END)
	           FROM COUNTRIES_REGION
	           WHERE COUNTRIES_REGION.COMP_CODE =  #{loginCompCode,jdbcType=NUMERIC} 
	           AND COUNTRIES_REGION.COUNTRY_CODE = #{kycAddressCountryCode,jdbcType=NUMERIC}
	           AND COUNTRIES_REGION.REGION_CODE =  #{kycRegion,jdbcType=NUMERIC})kycRegionDesc,
	           
	    (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN BRIEF_DESC_ENG ELSE BRIEF_DESC_ARAB END)   
		  FROM CIF_KYC_PARAMETERS
		  WHERE COMP_CODE = #{loginCompCode,jdbcType=NUMERIC} 
		  AND CODE= #{cifKYCVO.TYPE_OF_ACCOUNT,jdbcType=NUMERIC}
		  AND KYC_PARAM_TYPE = 'T')ymcTypeOfAccountDesc,
	    (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN BRIEF_DESC_ENG ELSE BRIEF_DESC_ARAB END)   
		  FROM CIF_KYC_PARAMETERS
		  WHERE COMP_CODE = #{loginCompCode,jdbcType=NUMERIC} 
		  AND CODE= #{cifKYCVO.SOURCE_WEALTH,jdbcType=NUMERIC}
		  AND KYC_PARAM_TYPE =  'S')kycSourceOfWealth,
	    (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  
	      FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  
	      AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.COMP_PHONE_COUNTRY,jdbcType=NUMERIC})ymcOtherCntryDesc,
	    (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  
	      FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  
	      AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.RECEIVE_INCOME_COUNTRY_CODE,jdbcType=NUMERIC})recvIncomeCntryDesc,
	    (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN COUNTRIES.LONG_DESC_ENG ELSE COUNTRIES.LONG_DESC_ARAB END)  
	      FROM COUNTRIES WHERE COUNTRIES.COMP_CODE = #{loginCompCode,jdbcType=NUMERIC}  
	      AND COUNTRIES.COUNTRY_CODE =  #{cifKYCVO.COMP_COUNTRY_CODE,jdbcType=NUMERIC})compCountryDesc,
	    (SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN BRIEF_DESC_ENG ELSE BRIEF_DESC_ARAB END)   
		  FROM CIF_KYC_PARAMETERS
		  WHERE COMP_CODE = #{loginCompCode,jdbcType=NUMERIC} 
		  AND CODE= #{cifKYCVO.INCOME_THROUGH,jdbcType=NUMERIC}
		  AND KYC_PARAM_TYPE = 'P')incomeThroughDesc,
		(SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN BRIEF_DESC_ENG ELSE BRIEF_DESC_ARAB END)   
		  FROM CIF_KYC_PARAMETERS
		  WHERE COMP_CODE = #{loginCompCode,jdbcType=NUMERIC} 
		  AND CODE= #{cifKYCVO.DEPOSIT_THROUGH,jdbcType=NUMERIC}
		  AND KYC_PARAM_TYPE = 'P')depositThroughDesc,
		(SELECT (CASE WHEN #{preferredLanguage,jdbcType=VARCHAR} = 'L' THEN LONG_NAME_ENG ELSE LONG_NAME_ARAB END)   
			FROM  FATCA_FINANCIAL_INST  
			WHERE FATCA_FINANCIAL_INST.COMP_CODE  =#{loginCompCode,jdbcType=NUMERIC} 
			AND   FINANCIAL_INS_CODE=#{cifKYCVO.FINANCIAL_INS_CODE,jdbcType=NUMERIC})ymcStatusDesc
		
		<if test="isOracle == 1"> 
			FROM DUAL
		</if>
		
	</select>
	
</mapper>