<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
        
<mapper namespace="misExt">

<sql id="getMismatchListSql">
	SELECT 
		   FTR_MISMATCH_REPORT.COMP_CODE|| TMPLT_CODE || LINE_NO || TMPLT_CODE1 || SUB_LINE_NO AS concatKey,
		   FTR_MISMATCH_REPORT.COMP_CODE COMP_CODE,
	       FTR_MISMATCH_REPORT.TMPLT_CODE TMPLT_CODE,
	       FTR_MISMATCH_REPORT.LINE_NO LINE_NO,
	       FTR_MISMATCH_REPORT.TMPLT_CODE1 TMPLT_CODE1,
	       (SELECT GLSTMPLT.BRIEF_NAME_ENG
	          FROM GLSTMPLT
	         WHERE GLSTMPLT.COMP_CODE = FTR_MISMATCH_REPORT.COMP_CODE
	           AND GLSTMPLT.CODE = FTR_MISMATCH_REPORT.TMPLT_CODE1
	           AND GLSTMPLT.COMP_CODE = #{COMP_CODE}
	           AND GLSTMPLT.LINE_NBR = 0) TMPLT_NAME,
	       FTR_MISMATCH_REPORT.SUB_LINE_NO SUB_LINE_NO,
	       (SELECT GLSTMPLT.BRIEF_NAME_ENG 
	          FROM GLSTMPLT
	         WHERE GLSTMPLT.COMP_CODE = FTR_MISMATCH_REPORT.COMP_CODE
	           AND GLSTMPLT.CODE = FTR_MISMATCH_REPORT.TMPLT_CODE1
	           AND GLSTMPLT.LINE_NBR = FTR_MISMATCH_REPORT.SUB_LINE_NO  
	           AND GLSTMPLT.COMP_CODE = #{COMP_CODE}) LINE_NAME
	  FROM FTR_MISMATCH_REPORT, GLSTMPLT
	 WHERE FTR_MISMATCH_REPORT.COMP_CODE = GLSTMPLT.COMP_CODE
	   AND FTR_MISMATCH_REPORT.TMPLT_CODE = GLSTMPLT.CODE
	   AND FTR_MISMATCH_REPORT.LINE_NO = GLSTMPLT.LINE_NBR
	   AND FTR_MISMATCH_REPORT.COMP_CODE = #{COMP_CODE}
	   AND FTR_MISMATCH_REPORT.TMPLT_CODE = #{CODE}
	   AND FTR_MISMATCH_REPORT.LINE_NO = #{LINE_NBR}
</sql>


<sql id="getTemplateNameDependency">
	SELECT BRIEF_NAME_ENG FROM GLSTMPLT WHERE LINE_NBR = 0 AND CODE = #{CODE} AND COMP_CODE = #{COMP_CODE}
</sql>

<sql id="getLineNameDependency">
	SELECT BRIEF_NAME_ENG FROM GLSTMPLT WHERE LINE_NBR = #{LINE_NBR} AND CODE = #{CODE} AND COMP_CODE = #{COMP_CODE}
</sql>

</mapper>